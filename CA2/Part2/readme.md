# Tutorial for Gradle Conversion of Spring Boot Project

Welcome to the tutorial for converting a Maven-based Spring Boot project to Gradle. By following this guide, you will transition the build automation tool to Gradle, and implement the necessary configurations for a Spring Boot application.

## Getting Started

1. Create a new branch in your repository named `tut-basic-gradle`.

```bash
git checkout -b tut-basic-gradle
```

2. Visit [Spring Initializr](https://start.spring.io) to initialize a new Spring Boot project with Gradle. Use the following settings:

- **Project**: Gradle - Groovy
          - **Language**: Java
          - **Spring Boot**: 3.2.4 
          - **Group**: com.greglturnquist
          - **Artifact**: react-and-spring-data-rest-basic
          - **Name**: react-and-spring-data-rest-basic
          - **Description**: Demo project for Spring Boot
          - **Packaging**: Jar
          - **Java**: 17
          - **Dependencies**: Spring Web, Thymeleaf, Spring Data JPA, H2 Database

## Setting Up the Project

1. Extract the downloaded ZIP file inside your project directory, e.g., `CA2/Part2/`.

```bash
unzip react-and-spring-data-rest-basic.zip -d CA2/Part2/
```

2. Navigate to the project directory.

```bash
cd CA2/Part2/react-and-spring-data-rest-basic
```

3. Verify that the project uses Gradle by running `./gradlew tasks` in your terminal.

```bash
./gradlew tasks
```

4. Remove the existing `src` directory.

```bash
rm -rf src
```

5. Copy over the `src` directory from the Maven-based project into this new project.

```bash
cp -R src ../../CA2/Part2/react-and-spring-data-rest-basic/
```

6. Copy also the files webpack.config.js and package.json from the Maven-based project into this new project.

```bash
cp webpack.config.js ../../CA2/Part2/react-and-spring-data-rest-basic/
cp package.json ../../CA2/Part2/react-and-spring-data-rest-basic/
```

7. Delete the folder src/main/resources/static/built/ since this folder should be generated from the javascrit by the webpack tool.
    
```bash
cd ../../CA2/Part2/react-and-spring-data-rest-basic/
rm -rf src/main/resources/static/built/
```

8. Experiment with the application by running it.

```bash
./gradlew bootRun
```

9. Visit `http://localhost:8080` in your browser to see the application in action.

## Configuring Frontend Plugin

1. Add the `org.siouan.frontend` plugin to your `build.gradle` file according to your Java version:

```gradle
plugins {
    id "org.siouan.frontend-jdk17" version "8.0.0"
}
```

2. Add also the following code in build.gradle to configure the previous plug-in:

```gradle
frontend {
    nodeVersion = '16.20.2'
    assembleScript = 'run build'
    cleanScript = "run clean"
    checkScript = "run check"
}
```

3. Update the scripts section/object in package.json to configure the execution of webpack:
    
```json
"scripts": {
"webpack": "webpack",
"build": "npm run webpack",
"check": "echo Checking frontend",
"clean": "echo Cleaning frontend"
"lint": "echo Linting frontend",
"test": "echo Testing frontend"
  },
```

## Building and Running the Project

1. Build the project using Gradle:

```bash
./gradlew build
```

2. Start the application:

```bash
./gradlew bootRun
```

## Additional Gradle Tasks

1. Add a task to copy the generated JAR to a dist directory at the project root.

```gradle
task copyJarToDist(type: Copy) {
	doFirst {
		mkdir 'dist'
	}

	dependsOn jar

	from jar.archivePath

	into 'dist'
}
```

2. Add a task to delete files generated by webpack from src/main/resources/static/built/. This new task should be executed
   automatically by gradle before the task clean.

```gradle
task cleanWebpack(type: Delete) {
    delete 'src/main/resources/static/built/'
}

clean.dependsOn cleanWebpack
```

## Finalizing

1. Test all features to ensure they are working as expected.
```bash
./gradlew build
./gradlew bootRun
```

2. Merge your code into the master branch after final testing and validation.

```bash
git checkout main
git merge tut-basic-gradle --no-ff
```

3. Push the changes to the remote repository.

```bash
git push origin main
```

4. Tag your repository with ca2-part2 to mark the completion of this part of the assignment.

```bash
git tag ca2-part2
git push origin ca2-part2
```

# Apache Ant - Alternative solution

## Configuring Frontend Build

```xml
<project name="react-and-spring-data-rest-basic" default="build" basedir=".">

    <!-- Define properties -->
    <property name="webpack.dir" value="node_modules/.bin" />
    <property name="webpack.command" value="${webpack.dir}/webpack" />

    <!-- Define targets -->
    <target name="clean">
        <echo message="Cleaning frontend" />
        <!-- Add commands to clean frontend -->
    </target>

    <target name="check">
        <echo message="Checking frontend" />
        <!-- Add commands to check frontend -->
    </target>

    <target name="webpack">
        <echo message="Running webpack" />
        <exec executable="${webpack.command}" failonerror="true" />
    </target>

    <target name="build" depends="webpack">
        <echo message="Building project" />
        <!-- Add commands to build project -->
    </target>

</project>
```

## Building and Running the Project

1. Build the project using Apache Ant:

```bash
ant build
```

2. Start the application:

```bash
java -jar target/*.jar
```

## Additional Ant Targets

1. Add a target to copy the generated JAR to a dist directory at the project root.

```xml
<target name="copy-jar-to-dist" depends="build">
    <echo message="Copying JAR to dist directory" />
    <copy file="target/*.jar" todir="dist" />
</target>
```

2. Add a target to delete files generated by webpack from src/main/resources/static/built/. This new target should be executed
   automatically by Ant before the clean target.

```xml
<target name="clean-webpack">
    <echo message="Cleaning webpack-generated files" />
    <delete dir="src/main/resources/static/built" />
</target>

<target name="clean" depends="clean-webpack">
    <echo message="Cleaning project" />
    <!-- Add commands to clean project -->
</target>
```

## Conclusion

I have successfully converted a Maven-based Spring Boot project to Gradle. I have also configured the necessary settings for building and running the project using Apache Ant.